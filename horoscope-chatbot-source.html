<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Astrology Consultant - Source Code</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #222;
            background-color: #ffffff;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .back-nav {
            margin-bottom: 20px;
        }

        .back-nav a {
            color: #007BFF;
            text-decoration: none;
            font-size: 1rem;
        }

        .back-nav a:hover {
            text-decoration: underline;
        }

        .project-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: linear-gradient(135deg, #FF9800, #F57C00);
            color: white;
            border-radius: 10px;
        }

        .project-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .project-header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .badges {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .badge {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
        }

        .content-section {
            margin: 40px 0;
            padding: 30px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border-left: 5px solid #FF9800;
        }

        .content-section h2 {
            color: #FF9800;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .content-section h3 {
            color: #333;
            margin: 20px 0 10px 0;
            font-size: 1.3rem;
        }

        .highlight-box {
            background: linear-gradient(135deg, #FFF8E1, #FFF3C4);
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #FF9800;
            margin: 20px 0;
        }

        .code-container {
            background-color: #1e1e1e;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .code-header {
            color: #569cd6;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.1rem;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }

        .code-block {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            color: #d4d4d4;
        }

        .code-comment {
            color: #6a9955;
            font-style: italic;
        }

        .code-keyword {
            color: #569cd6;
        }

        .code-string {
            color: #ce9178;
        }

        .code-function {
            color: #dcdcaa;
        }

        .code-number {
            color: #b5cea8;
        }

        .demo-links {
            text-align: center;
            margin: 30px 0;
        }

        .demo-btn {
            display: inline-block;
            background-color: #007BFF;
            color: white;
            padding: 12px 25px;
            text-decoration: none;
            border-radius: 5px;
            margin: 0 10px;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .demo-btn:hover {
            background-color: #0056b3;
        }

        .demo-btn.secondary {
            background-color: #28a745;
        }

        .demo-btn.secondary:hover {
            background-color: #218838;
        }

        @media (max-width: 768px) {
            .project-header h1 {
                font-size: 2rem;
            }

            .project-header p {
                font-size: 1rem;
            }

            .demo-btn {
                margin: 5px;
                padding: 10px 20px;
            }

            .container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <nav class="back-nav">
            <a href="horoscope-chatbot.html">‚Üê Back to Project Overview</a>
        </nav>

        <div class="project-header">
            <h1>‚≠ê Professional Astrology Consultant</h1>
            <p>Core Source Code & Astrological Intelligence Implementation</p>

            <div class="badges">
                <span class="badge">Python 3.9</span>
                <span class="badge">Streamlit</span>
                <span class="badge">Gemini AI</span>
                <span class="badge">Astrology Engine</span>
            </div>
        </div>

        <div class="highlight-box">
            <h3>üîç About This Code Showcase</h3>
            <p><strong>This curated code snippet demonstrates how the Professional Astrology Consultant calculates birth charts, analyzes planetary positions, and provides personalized astrological insights based on traditional western astrology principles.</strong></p>
            <p>Full deployment scripts, API integrations, and proprietary details are omitted for clarity and security. This showcase highlights the core astrological calculation and personality analysis algorithms.</p>
        </div>

        <div class="content-section">
            <h2>üåü Core Algorithm: Astrological Chart Calculator</h2>
            <p>The foundation of the Professional Astrology Consultant is its ability to calculate precise birth charts, determine planetary positions, and analyze astrological aspects for comprehensive personality and life guidance:</p>

            <div class="code-container">
                <div class="code-header">üìÑ astrology_calculator.py</div>
                <div class="code-block">
<span class="code-keyword">import</span> ephem
<span class="code-keyword">import</span> google.generativeai <span class="code-keyword">as</span> genai
<span class="code-keyword">import</span> datetime
<span class="code-keyword">from</span> typing <span class="code-keyword">import</span> Dict, List, Tuple
<span class="code-keyword">import</span> math

<span class="code-keyword">class</span> <span class="code-function">AstrologyCalculator</span>:
    <span class="code-string">"""
    Professional astrology calculation engine that computes birth charts,
    planetary positions, and astrological aspects for comprehensive readings.
    """</span>

    <span class="code-keyword">def</span> <span class="code-function">__init__</span>(self, api_key: str):
        genai.configure(api_key=api_key)
        self.astro_ai = genai.GenerativeModel(<span class="code-string">'gemini-pro'</span>)

        <span class="code-comment"># Zodiac signs with their characteristics and ruling planets</span>
        self.zodiac_signs = {
            <span class="code-string">'Aries'</span>: {<span class="code-string">'element'</span>: <span class="code-string">'Fire'</span>, <span class="code-string">'quality'</span>: <span class="code-string">'Cardinal'</span>, <span class="code-string">'ruler'</span>: <span class="code-string">'Mars'</span>, <span class="code-string">'degree_range'</span>: (<span class="code-number">0</span>, <span class="code-number">30</span>)},
            <span class="code-string">'Taurus'</span>: {<span class="code-string">'element'</span>: <span class="code-string">'Earth'</span>, <span class="code-string">'quality'</span>: <span class="code-string">'Fixed'</span>, <span class="code-string">'ruler'</span>: <span class="code-string">'Venus'</span>, <span class="code-string">'degree_range'</span>: (<span class="code-number">30</span>, <span class="code-number">60</span>)},
            <span class="code-string">'Gemini'</span>: {<span class="code-string">'element'</span>: <span class="code-string">'Air'</span>, <span class="code-string">'quality'</span>: <span class="code-string">'Mutable'</span>, <span class="code-string">'ruler'</span>: <span class="code-string">'Mercury'</span>, <span class="code-string">'degree_range'</span>: (<span class="code-number">60</span>, <span class="code-number">90</span>)},
            <span class="code-string">'Cancer'</span>: {<span class="code-string">'element'</span>: <span class="code-string">'Water'</span>, <span class="code-string">'quality'</span>: <span class="code-string">'Cardinal'</span>, <span class="code-string">'ruler'</span>: <span class="code-string">'Moon'</span>, <span class="code-string">'degree_range'</span>: (<span class="code-number">90</span>, <span class="code-number">120</span>)},
            <span class="code-string">'Leo'</span>: {<span class="code-string">'element'</span>: <span class="code-string">'Fire'</span>, <span class="code-string">'quality'</span>: <span class="code-string">'Fixed'</span>, <span class="code-string">'ruler'</span>: <span class="code-string">'Sun'</span>, <span class="code-string">'degree_range'</span>: (<span class="code-number">120</span>, <span class="code-number">150</span>)},
            <span class="code-string">'Virgo'</span>: {<span class="code-string">'element'</span>: <span class="code-string">'Earth'</span>, <span class="code-string">'quality'</span>: <span class="code-string">'Mutable'</span>, <span class="code-string">'ruler'</span>: <span class="code-string">'Mercury'</span>, <span class="code-string">'degree_range'</span>: (<span class="code-number">150</span>, <span class="code-number">180</span>)}
        }

        <span class="code-comment"># Astrological houses and their life areas</span>
        self.houses = {
            <span class="code-number">1</span>: {<span class="code-string">'name'</span>: <span class="code-string">'Self & Identity'</span>, <span class="code-string">'keywords'</span>: [<span class="code-string">'personality'</span>, <span class="code-string">'appearance'</span>, <span class="code-string">'first impressions'</span>]},
            <span class="code-number">2</span>: {<span class="code-string">'name'</span>: <span class="code-string">'Money & Values'</span>, <span class="code-string">'keywords'</span>: [<span class="code-string">'finances'</span>, <span class="code-string">'possessions'</span>, <span class="code-string">'self-worth'</span>]},
            <span class="code-number">3</span>: {<span class="code-string">'name'</span>: <span class="code-string">'Communication'</span>, <span class="code-string">'keywords'</span>: [<span class="code-string">'siblings'</span>, <span class="code-string">'short trips'</span>, <span class="code-string">'learning'</span>]},
            <span class="code-number">4</span>: {<span class="code-string">'name'</span>: <span class="code-string">'Home & Family'</span>, <span class="code-string">'keywords'</span>: [<span class="code-string">'roots'</span>, <span class="code-string">'mother'</span>, <span class="code-string">'real estate'</span>]},
            <span class="code-number">5</span>: {<span class="code-string">'name'</span>: <span class="code-string">'Creativity & Romance'</span>, <span class="code-string">'keywords'</span>: [<span class="code-string">'children'</span>, <span class="code-string">'art'</span>, <span class="code-string">'pleasure'</span>]},
            <span class="code-number">7</span>: {<span class="code-string">'name'</span>: <span class="code-string">'Partnerships'</span>, <span class="code-string">'keywords'</span>: [<span class="code-string">'marriage'</span>, <span class="code-string">'business partners'</span>, <span class="code-string">'open enemies'</span>]},
            <span class="code-number">10</span>: {<span class="code-string">'name'</span>: <span class="code-string">'Career & Reputation'</span>, <span class="code-string">'keywords'</span>: [<span class="code-string">'profession'</span>, <span class="code-string">'public image'</span>, <span class="code-string">'father'</span>]}
        }

        <span class="code-comment"># Major planetary aspects and their influences</span>
        self.aspects = {
            <span class="code-string">'conjunction'</span>: {<span class="code-string">'degrees'</span>: <span class="code-number">0</span>, <span class="code-string">'orb'</span>: <span class="code-number">8</span>, <span class="code-string">'nature'</span>: <span class="code-string">'neutral'</span>, <span class="code-string">'strength'</span>: <span class="code-string">'major'</span>},
            <span class="code-string">'opposition'</span>: {<span class="code-string">'degrees'</span>: <span class="code-number">180</span>, <span class="code-string">'orb'</span>: <span class="code-number">8</span>, <span class="code-string">'nature'</span>: <span class="code-string">'challenging'</span>, <span class="code-string">'strength'</span>: <span class="code-string">'major'</span>},
            <span class="code-string">'trine'</span>: {<span class="code-string">'degrees'</span>: <span class="code-number">120</span>, <span class="code-string">'orb'</span>: <span class="code-number">8</span>, <span class="code-string">'nature'</span>: <span class="code-string">'harmonious'</span>, <span class="code-string">'strength'</span>: <span class="code-string">'major'</span>},
            <span class="code-string">'square'</span>: {<span class="code-string">'degrees'</span>: <span class="code-number">90</span>, <span class="code-string">'orb'</span>: <span class="code-number">8</span>, <span class="code-string">'nature'</span>: <span class="code-string">'challenging'</span>, <span class="code-string">'strength'</span>: <span class="code-string">'major'</span>},
            <span class="code-string">'sextile'</span>: {<span class="code-string">'degrees'</span>: <span class="code-number">60</span>, <span class="code-string">'orb'</span>: <span class="code-number">6</span>, <span class="code-string">'nature'</span>: <span class="code-string">'harmonious'</span>, <span class="code-string">'strength'</span>: <span class="code-string">'minor'</span>}
        }

    <span class="code-keyword">def</span> <span class="code-function">calculate_birth_chart</span>(self, birth_date: datetime.datetime,
                           birth_time: datetime.time,
                           birth_location: Tuple[float, float]) -> Dict:
        <span class="code-string">"""
        Calculate complete birth chart with planetary positions and house cusps.

        Args:
            birth_date: Date of birth
            birth_time: Exact time of birth
            birth_location: (latitude, longitude) of birth location

        Returns:
            Dictionary containing complete astrological chart data
        """</span>

        <span class="code-comment"># Combine date and time for astronomical calculations</span>
        birth_datetime = datetime.datetime.combine(birth_date, birth_time)

        <span class="code-comment"># Step 1: Calculate planetary positions</span>
        planetary_positions = self._calculate_planetary_positions(birth_datetime)

        <span class="code-comment"># Step 2: Calculate house cusps (requires birth location)</span>
        house_cusps = self._calculate_house_cusps(birth_datetime, birth_location)

        <span class="code-comment"># Step 3: Determine zodiac placements for each planet</span>
        zodiac_placements = self._determine_zodiac_placements(planetary_positions)

        <span class="code-comment"># Step 4: Calculate major aspects between planets</span>
        aspects = self._calculate_planetary_aspects(planetary_positions)

        <span class="code-comment"># Step 5: Determine planet-house relationships</span>
        planet_house_positions = self._calculate_planet_houses(
            planetary_positions, house_cusps
        )

        <span class="code-comment"># Step 6: Generate astrological analysis</span>
        chart_analysis = <span class="code-keyword">await</span> self._generate_chart_analysis(
            zodiac_placements, aspects, planet_house_positions
        )

        <span class="code-keyword">return</span> {
            <span class="code-string">'birth_info'</span>: {
                <span class="code-string">'date_time'</span>: birth_datetime.isoformat(),
                <span class="code-string">'location'</span>: birth_location
            },
            <span class="code-string">'planetary_positions'</span>: planetary_positions,
            <span class="code-string">'zodiac_placements'</span>: zodiac_placements,
            <span class="code-string">'house_cusps'</span>: house_cusps,
            <span class="code-string">'planet_houses'</span>: planet_house_positions,
            <span class="code-string">'aspects'</span>: aspects,
            <span class="code-string">'chart_analysis'</span>: chart_analysis,
            <span class="code-string">'chart_summary'</span>: self._generate_chart_summary(zodiac_placements, aspects)
        }

    <span class="code-keyword">def</span> <span class="code-function">_calculate_planetary_positions</span>(self, birth_datetime: datetime.datetime) -> Dict:
        <span class="code-string">"""
        Calculate precise astronomical positions of planets at birth time.
        Uses PyEphem for accurate celestial mechanics calculations.
        """</span>

        <span class="code-comment"># Create observer at birth time</span>
        observer = ephem.Observer()
        observer.date = birth_datetime

        planetary_positions = {}

        <span class="code-comment"># Calculate positions for traditional astrological planets</span>
        planets = {
            <span class="code-string">'Sun'</span>: ephem.Sun(),
            <span class="code-string">'Moon'</span>: ephem.Moon(),
            <span class="code-string">'Mercury'</span>: ephem.Mercury(),
            <span class="code-string">'Venus'</span>: ephem.Venus(),
            <span class="code-string">'Mars'</span>: ephem.Mars(),
            <span class="code-string">'Jupiter'</span>: ephem.Jupiter(),
            <span class="code-string">'Saturn'</span>: ephem.Saturn(),
            <span class="code-string">'Uranus'</span>: ephem.Uranus(),
            <span class="code-string">'Neptune'</span>: ephem.Neptune(),
            <span class="code-string">'Pluto'</span>: ephem.Pluto()
        }

        <span class="code-keyword">for</span> planet_name, planet_obj <span class="code-keyword">in</span> planets.items():
            planet_obj.compute(observer)

            <span class="code-comment"># Convert astronomical coordinates to astrological degrees</span>
            ecliptic_longitude = math.degrees(planet_obj.hlong)

            planetary_positions[planet_name] = {
                <span class="code-string">'longitude'</span>: ecliptic_longitude,
                <span class="code-string">'latitude'</span>: math.degrees(planet_obj.hlat),
                <span class="code-string">'distance'</span>: planet_obj.earth_distance,
                <span class="code-string">'speed'</span>: self._calculate_planetary_speed(planet_obj, observer),
                <span class="code-string">'retrograde'</span>: self._is_retrograde(planet_obj, observer)
            }

        <span class="code-keyword">return</span> planetary_positions

    <span class="code-keyword">def</span> <span class="code-function">_determine_zodiac_placements</span>(self, planetary_positions: Dict) -> Dict:
        <span class="code-string">"""
        Determine which zodiac sign each planet occupies and calculate degrees.
        Provides detailed placement information for astrological interpretation.
        """</span>

        zodiac_placements = {}

        <span class="code-keyword">for</span> planet, position_data <span class="code-keyword">in</span> planetary_positions.items():
            longitude = position_data[<span class="code-string">'longitude'</span>]

            <span class="code-comment"># Normalize longitude to 0-360 degree range</span>
            normalized_longitude = longitude % <span class="code-number">360</span>

            <span class="code-comment"># Determine zodiac sign (each sign is 30 degrees)</span>
            sign_index = int(normalized_longitude // <span class="code-number">30</span>)
            degree_in_sign = normalized_longitude % <span class="code-number">30</span>

            zodiac_sign_names = list(self.zodiac_signs.keys())
            sign_name = zodiac_sign_names[sign_index]

            zodiac_placements[planet] = {
                <span class="code-string">'sign'</span>: sign_name,
                <span class="code-string">'degree'</span>: degree_in_sign,
                <span class="code-string">'element'</span>: self.zodiac_signs[sign_name][<span class="code-string">'element'</span>],
                <span class="code-string">'quality'</span>: self.zodiac_signs[sign_name][<span class="code-string">'quality'</span>],
                <span class="code-string">'ruling_planet'</span>: self.zodiac_signs[sign_name][<span class="code-string">'ruler'</span>],
                <span class="code-string">'retrograde'</span>: position_data[<span class="code-string">'retrograde'</span>],
                <span class="code-string">'placement_strength'</span>: self._calculate_placement_strength(planet, sign_name)
            }

        <span class="code-keyword">return</span> zodiac_placements

    <span class="code-keyword">def</span> <span class="code-function">_calculate_planetary_aspects</span>(self, planetary_positions: Dict) -> List[Dict]:
        <span class="code-string">"""
        Calculate major and minor aspects between planets in the birth chart.
        Identifies harmonious and challenging planetary relationships.
        """</span>

        aspects = []
        planet_names = list(planetary_positions.keys())

        <span class="code-comment"># Check every planet pair for aspects</span>
        <span class="code-keyword">for</span> i <span class="code-keyword">in</span> range(len(planet_names)):
            <span class="code-keyword">for</span> j <span class="code-keyword">in</span> range(i + <span class="code-number">1</span>, len(planet_names)):
                planet1 = planet_names[i]
                planet2 = planet_names[j]

                lon1 = planetary_positions[planet1][<span class="code-string">'longitude'</span>] % <span class="code-number">360</span>
                lon2 = planetary_positions[planet2][<span class="code-string">'longitude'</span>] % <span class="code-number">360</span>

                <span class="code-comment"># Calculate angular separation</span>
                separation = abs(lon1 - lon2)
                <span class="code-keyword">if</span> separation > <span class="code-number">180</span>:
                    separation = <span class="code-number">360</span> - separation

                <span class="code-comment"># Check for major aspects within orb</span>
                <span class="code-keyword">for</span> aspect_name, aspect_data <span class="code-keyword">in</span> self.aspects.items():
                    target_angle = aspect_data[<span class="code-string">'degrees'</span>]
                    orb = aspect_data[<span class="code-string">'orb'</span>]

                    <span class="code-keyword">if</span> abs(separation - target_angle) <= orb:
                        aspects.append({
                            <span class="code-string">'planet1'</span>: planet1,
                            <span class="code-string">'planet2'</span>: planet2,
                            <span class="code-string">'aspect'</span>: aspect_name,
                            <span class="code-string">'exact_angle'</span>: separation,
                            <span class="code-string">'orb_difference'</span>: abs(separation - target_angle),
                            <span class="code-string">'nature'</span>: aspect_data[<span class="code-string">'nature'</span>],
                            <span class="code-string">'strength'</span>: aspect_data[<span class="code-string">'strength'</span>],
                            <span class="code-string">'interpretation'</span>: self._interpret_aspect(planet1, planet2, aspect_name)
                        })

        <span class="code-comment"># Sort aspects by strength and exactness</span>
        <span class="code-keyword">return</span> sorted(aspects, key=<span class="code-keyword">lambda</span> x: (x[<span class="code-string">'strength'</span>] == <span class="code-string">'major'</span>, -x[<span class="code-string">'orb_difference'</span>]), reverse=<span class="code-keyword">True</span>)
                </div>
            </div>
        </div>

        <div class="content-section">
            <h2>üîÆ Advanced Interpretation Engine</h2>
            <p>The interpretation engine synthesizes chart elements to provide comprehensive personality analysis, relationship compatibility, and life guidance based on traditional astrological principles:</p>

            <div class="code-container">
                <div class="code-header">üìÑ astrology_interpreter.py</div>
                <div class="code-block">
<span class="code-keyword">class</span> <span class="code-function">AstrologyInterpreter</span>:
    <span class="code-keyword">async</span> <span class="code-function">_generate_chart_analysis</span>(
        self, zodiac_placements: Dict, aspects: List[Dict], planet_houses: Dict
    ) -> Dict:
        <span class="code-string">"""
        Generate comprehensive astrological analysis combining all chart elements.
        Provides insights into personality, relationships, career, and life purpose.
        """</span>

        analysis_prompt = f<span class="code-string">"""
        Provide a professional astrological reading based on this birth chart:

        PLANETARY PLACEMENTS:
        {self._format_placements_for_analysis(zodiac_placements)}

        MAJOR ASPECTS:
        {self._format_aspects_for_analysis(aspects[:5])}  # Top 5 strongest aspects

        HOUSE POSITIONS:
        {self._format_houses_for_analysis(planet_houses)}

        Generate a comprehensive reading covering:

        1. CORE PERSONALITY: Sun, Moon, and Rising sign synthesis
        2. EMOTIONAL NATURE: Moon sign and aspects to emotional planets
        3. COMMUNICATION STYLE: Mercury placement and aspects
        4. LOVE & RELATIONSHIPS: Venus placement and 7th house analysis
        5. CAREER & AMBITION: Mars, Saturn, and 10th house influences
        6. LIFE CHALLENGES: Difficult aspects and their growth opportunities
        7. NATURAL TALENTS: Harmonious aspects and strong planetary placements
        8. SPIRITUAL PATH: Higher octave planets and their influences

        Provide specific, actionable insights based on traditional astrological wisdom.
        Include both strengths and areas for personal development.
        """</span>

        response = <span class="code-keyword">await</span> self.astro_ai.generate_content_async(analysis_prompt)

        <span class="code-keyword">return</span> {
            <span class="code-string">'comprehensive_reading'</span>: response.text,
            <span class="code-string">'personality_summary'</span>: self._extract_personality_highlights(zodiac_placements),
            <span class="code-string">'elemental_balance'</span>: self._analyze_elemental_balance(zodiac_placements),
            <span class="code-string">'modal_emphasis'</span>: self._analyze_modal_qualities(zodiac_placements),
            <span class="code-string">'chart_patterns'</span>: self._identify_chart_patterns(aspects, planet_houses)
        }

    <span class="code-keyword">def</span> <span class="code-function">_analyze_elemental_balance</span>(self, zodiac_placements: Dict) -> Dict:
        <span class="code-string">"""
        Analyze the distribution of elements (Fire, Earth, Air, Water) in the chart.
        Reveals fundamental temperament and approach to life.
        """</span>

        element_counts = {<span class="code-string">'Fire'</span>: <span class="code-number">0</span>, <span class="code-string">'Earth'</span>: <span class="code-number">0</span>, <span class="code-string">'Air'</span>: <span class="code-number">0</span>, <span class="code-string">'Water'</span>: <span class="code-number">0</span>}

        <span class="code-comment"># Weight planets by importance (Sun, Moon, Rising get more weight)</span>
        planet_weights = {
            <span class="code-string">'Sun'</span>: <span class="code-number">3</span>, <span class="code-string">'Moon'</span>: <span class="code-number">3</span>, <span class="code-string">'Mercury'</span>: <span class="code-number">2</span>, <span class="code-string">'Venus'</span>: <span class="code-number">2</span>, <span class="code-string">'Mars'</span>: <span class="code-number">2</span>,
            <span class="code-string">'Jupiter'</span>: <span class="code-number">1</span>, <span class="code-string">'Saturn'</span>: <span class="code-number">1</span>, <span class="code-string">'Uranus'</span>: <span class="code-number">0.5</span>, <span class="code-string">'Neptune'</span>: <span class="code-number">0.5</span>, <span class="code-string">'Pluto'</span>: <span class="code-number">0.5</span>
        }

        <span class="code-keyword">for</span> planet, placement <span class="code-keyword">in</span> zodiac_placements.items():
            element = placement[<span class="code-string">'element'</span>]
            weight = planet_weights.get(planet, <span class="code-number">1</span>)
            element_counts[element] += weight

        <span class="code-comment"># Determine dominant and lacking elements</span>
        total_weight = sum(element_counts.values())
        element_percentages = {elem: (count / total_weight) * <span class="code-number">100</span>
                             <span class="code-keyword">for</span> elem, count <span class="code-keyword">in</span> element_counts.items()}

        dominant_element = max(element_percentages, key=element_percentages.get)
        lacking_elements = [elem <span class="code-keyword">for</span> elem, pct <span class="code-keyword">in</span> element_percentages.items() <span class="code-keyword">if</span> pct < <span class="code-number">15</span>]

        <span class="code-keyword">return</span> {
            <span class="code-string">'element_distribution'</span>: element_percentages,
            <span class="code-string">'dominant_element'</span>: dominant_element,
            <span class="code-string">'lacking_elements'</span>: lacking_elements,
            <span class="code-string">'temperament_description'</span>: self._describe_elemental_temperament(dominant_element, lacking_elements),
            <span class="code-string">'balance_recommendations'</span>: self._suggest_elemental_balance(lacking_elements)
        }

    <span class="code-keyword">def</span> <span class="code-function">calculate_compatibility</span>(self, chart1: Dict, chart2: Dict) -> Dict:
        <span class="code-string">"""
        Calculate relationship compatibility between two birth charts.
        Analyzes synastry aspects and composite chart elements.
        """</span>

        <span class="code-comment"># Extract key placements from both charts</span>
        person1_placements = chart1[<span class="code-string">'zodiac_placements'</span>]
        person2_placements = chart2[<span class="code-string">'zodiac_placements'</span>]

        <span class="code-comment"># Calculate inter-chart aspects (synastry)</span>
        synastry_aspects = self._calculate_synastry_aspects(
            chart1[<span class="code-string">'planetary_positions'</span>],
            chart2[<span class="code-string">'planetary_positions'</span>]
        )

        <span class="code-comment"># Analyze elemental and modal compatibility</span>
        elemental_compatibility = self._analyze_elemental_compatibility(
            person1_placements, person2_placements
        )

        <span class="code-comment"># Check for significant romantic indicators</span>
        romantic_indicators = self._identify_romantic_indicators(synastry_aspects)

        <span class="code-comment"># Calculate overall compatibility score</span>
        compatibility_score = self._calculate_compatibility_score(
            synastry_aspects, elemental_compatibility, romantic_indicators
        )

        <span class="code-keyword">return</span> {
            <span class="code-string">'overall_score'</span>: compatibility_score,
            <span class="code-string">'synastry_aspects'</span>: synastry_aspects[:<span class="code-number">10</span>],  <span class="code-comment"># Top 10 most significant</span>
            <span class="code-string">'elemental_harmony'</span>: elemental_compatibility,
            <span class="code-string">'romantic_indicators'</span>: romantic_indicators,
            <span class="code-string">'relationship_strengths'</span>: self._identify_relationship_strengths(synastry_aspects),
            <span class="code-string">'potential_challenges'</span>: self._identify_relationship_challenges(synastry_aspects),
            <span class="code-string">'compatibility_summary'</span>: <span class="code-keyword">await</span> self._generate_compatibility_summary(
                compatibility_score, synastry_aspects, elemental_compatibility
            )
        }

    <span class="code-keyword">def</span> <span class="code-function">_identify_chart_patterns</span>(self, aspects: List[Dict], planet_houses: Dict) -> List[Dict]:
        <span class="code-string">"""
        Identify significant astrological patterns in the birth chart.
        Recognizes Grand Trines, T-Squares, Stelliums, and other configurations.
        """</span>

        patterns = []

        <span class="code-comment"># Check for stelliums (3+ planets in same sign or house)</span>
        stelliums = self._find_stelliums(planet_houses)
        patterns.extend(stelliums)

        <span class="code-comment"># Check for Grand Trines (three planets forming equilateral triangle)</span>
        grand_trines = self._find_grand_trines(aspects)
        patterns.extend(grand_trines)

        <span class="code-comment"># Check for T-Squares (challenging configuration)</span>
        t_squares = self._find_t_squares(aspects)
        patterns.extend(t_squares)

        <span class="code-comment"># Check for Grand Cross (very challenging but powerful configuration)</span>
        grand_crosses = self._find_grand_crosses(aspects)
        patterns.extend(grand_crosses)

        <span class="code-keyword">return</span> sorted(patterns, key=<span class="code-keyword">lambda</span> x: x[<span class="code-string">'significance'</span>], reverse=<span class="code-keyword">True</span>)
                </div>
            </div>
        </div>

        <div class="content-section">
            <h2>‚öôÔ∏è Technical Implementation Notes</h2>
            <h3>Key Algorithms & Innovations</h3>
            <ul style="margin: 15px 0; padding-left: 20px;">
                <li><strong>Astronomical Precision:</strong> PyEphem library provides accurate planetary position calculations</li>
                <li><strong>Traditional Astrology:</strong> Comprehensive implementation of classical astrological principles and house systems</li>
                <li><strong>Aspect Analysis:</strong> Advanced algorithms for detecting planetary relationships and chart patterns</li>
                <li><strong>Compatibility Calculations:</strong> Synastry analysis for relationship compatibility assessment</li>
                <li><strong>AI-Enhanced Interpretation:</strong> Gemini AI synthesizes chart elements for personalized readings</li>
            </ul>

            <h3>Why This Approach Works</h3>
            <ul style="margin: 15px 0; padding-left: 20px;">
                <li><strong>Scientific Accuracy:</strong> Astronomical calculations ensure precise planetary positions</li>
                <li><strong>Traditional Wisdom:</strong> Based on thousands of years of astrological knowledge and interpretation</li>
                <li><strong>Comprehensive Analysis:</strong> Considers all chart elements for holistic personality insights</li>
                <li><strong>Personalized Guidance:</strong> Tailored interpretations based on individual birth chart configurations</li>
            </ul>
        </div>

        <div class="demo-links">
            <a href="https://horoscope-chatbot-169218045868.us-west1.run.app/" target="_blank" class="demo-btn">üöÄ Try Live Demo</a>
            <a href="horoscope-chatbot.html" class="demo-btn secondary">üìñ View Full Project Details</a>
        </div>

        <nav class="back-nav" style="text-align: center; margin-top: 40px;">
            <a href="index.html">‚Üê Back to Portfolio</a> |
            <a href="horoscope-chatbot.html">View Project Overview</a>
        </nav>
    </div>
</body>
</html>