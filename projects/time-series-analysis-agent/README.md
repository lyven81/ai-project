# üìä Time Series Analysis Agent

[![Python](https://img.shields.io/badge/Python-3.8+-blue?logo=python)](https://python.org/)
[![Gemini AI](https://img.shields.io/badge/Gemini-2.0_Flash-purple?logo=google)](https://ai.google.dev/)
[![Pandas](https://img.shields.io/badge/Pandas-2.0+-green?logo=pandas)](https://pandas.pydata.org/)
[![Matplotlib](https://img.shields.io/badge/Matplotlib-3.7+-orange?logo=python)](https://matplotlib.org/)

AI-powered time series analysis agent that transforms natural language questions into executable data analytics code. Upload your e-commerce transaction data and ask questions in plain English to get insights, trends, and visualizations automatically generated by Google Gemini AI.

<div align="center">
<img width="1200" height="475" alt="Time Series Analysis Agent Banner" src="https://github.com/user-attachments/assets/placeholder-time-series-banner.png" />
</div>

## üöÄ Live Demo

**[üåü View Live Demo](#)** | [üìπ Video Demo](#)

## ‚ú® Features

- **ü§ñ Natural Language Queries:** Ask questions in plain English - no coding required
- **üìà Automated Code Generation:** Gemini AI generates Python/Pandas code from your questions
- **‚è±Ô∏è Time Series Analysis:** Monthly/quarterly trends, YoY comparisons, seasonal patterns
- **üìä Business Intelligence:** Product rankings, customer segmentation, profit margin analysis
- **üìâ Data Visualization:** Automatic chart generation (line, bar, scatter plots)
- **üîç Smart Error Handling:** Validates inputs and provides helpful suggestions
- **üí° Self-Correcting:** Status tracking (success, no_data, invalid_filter, etc.)
- **üéØ Multiple Analysis Types:** Revenue trends, correlation analysis, declining margins, repeat customers

## üõ†Ô∏è Tech Stack

**AI & Analytics:**
- **Google Gemini 2.0 Flash** - Natural language to code generation
- **Pandas** - Time series data manipulation and analysis
- **NumPy** - Numerical computations
- **Matplotlib & Seaborn** - Data visualization

**Python Framework:**
- **Python 3.8+** - Modern Python with async support
- **Google Generative AI SDK** - Gemini API integration
- **IPython** - Interactive computing and display

**Data Processing:**
- **DateTime** - Time series operations
- **Regular Expressions** - Code extraction and parsing
- **JSON** - Structured data handling

## üöÄ Quick Start

### Prerequisites
- **Python 3.8+**
- **Google Gemini API Key** from [Google AI Studio](https://aistudio.google.com/apikey)
- **CSV Dataset** with e-commerce transactions (Order_Date, Revenue, Profit, Category, etc.)

### Installation

```bash
# Clone the repository
git clone https://github.com/lyven81/ai-project.git
cd ai-project/projects/time-series-analysis-agent

# Create virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install dependencies
pip install -r requirements.txt

# Set up environment variables
cp .env.example .env
# Add your Gemini API key to .env
```

### Environment Configuration

Create a `.env` file in the root directory:

```env
# Required: Gemini API Key
GEMINI_API_KEY=your_gemini_api_key_here

# Optional: Configuration
MODEL_NAME=gemini-2.0-flash-exp
TEMPERATURE=0.2
MAX_OUTPUT_TOKENS=8192
```

### Running the Application

```bash
# Run in Jupyter Notebook or Google Colab
jupyter notebook time_series_analysis_agent.ipynb

# Or run as Python script
python time_series_analysis_agent.py
```

## üìñ Usage

### Basic Time Series Analysis

1. **Upload CSV Data:** Load your e-commerce transaction dataset
2. **Ask Questions in Natural Language:**
   - "Show me the monthly revenue trend for Electronics category in 2024"
   - "Compare Q4 2023 vs Q4 2024 revenue across all regions"
   - "What are the top 10 most profitable products?"
   - "Show scatter plot for correlation between purchase frequency and value"

3. **View Generated Code:** See the Python/Pandas code created by Gemini AI
4. **Get Insights:** Receive text summaries, tables, and visualizations

### Sample Questions

**Revenue & Profit Analysis:**
- "How has total revenue changed over time?"
- "What is the trend of total profit and revenue during dataset period?"
- "Does profit margin fluctuate seasonally throughout the year?"

**Product Performance:**
- "List top 10 most profitable products during dataset period"
- "Which product category has the highest profit margin?"
- "5 products with highest declining profit margins between January-June 2023?"

**Customer Insights:**
- "Show top 10 repeat customers by profit in bar chart"
- "How has the number of active or repeat customers changed over time?"
- "List top 5 most frequently purchasing customers and products they bought"

**Correlation Analysis:**
- "Show scatter plot showing correlation between profit margin and sales"
- "Can you give 10 products that show consistent profit margin?"

## üéØ Key Capabilities

### Time Series Operations
- **Filtering:** Date range, category, region, product-specific queries
- **Resampling:** Monthly/quarterly/yearly aggregations
- **Rolling Windows:** Moving averages and trend smoothing
- **Period Comparison:** YoY, QoQ growth analysis
- **Trend Detection:** Growth rates, seasonal patterns

### Analytics Functions
- `get_date_range(df, start, end)` - Filter by date range
- `get_quarter_data(df, year, quarter)` - Extract quarterly data
- `calculate_profit_margin(df)` - Compute profit margins
- `get_top_n(df, column, metric, n)` - Top performers
- `detect_outliers(series, threshold)` - Outlier detection

### Visualization Types
- Line charts for trends over time
- Bar charts for comparisons
- Scatter plots for correlations
- Multi-category overlays
- Custom color schemes and labels

## üìÇ Dataset Requirements

Your CSV file should include:
- **Order_Date** (datetime): Transaction timestamp
- **Revenue** (float): Sales amount
- **Profit** (float): Profit amount
- **Category** (string): Product category
- **Product_Name** (string): Product identifier
- **Region** (string): Geographic region
- **Customer_Name** (string): Customer identifier
- **Quantity** (int): Items sold

Example format:
```csv
Order_Date,Order_ID,Customer_Name,Category,Product_Name,Region,Revenue,Profit,Quantity
01-15-23,1001,John Doe,Electronics,MacBook Air,West,1299.99,450.00,1
```

## üîß Architecture

### Workflow
1. **User Input:** Natural language question
2. **Schema Generation:** Dataset structure and samples sent to Gemini
3. **Code Planning:** Gemini generates Python/Pandas code
4. **Code Extraction:** Regex parsing of `<execute_python>` blocks
5. **Safe Execution:** Sandboxed environment with helper functions
6. **Result Display:** Text summaries, DataFrames, and plots

### Error Handling
- **No Data:** Suggests alternative filters
- **Invalid Date:** Specifies correct format
- **Invalid Filter:** Lists available options
- **Ambiguous Request:** Asks clarifying questions
- **Execution Error:** Provides debug information

## üöÄ Deployment

### Google Colab (Recommended)
```python
# Upload to Google Colab
# Add GEMINI_API_KEY to Colab Secrets
# Run cells to upload CSV and analyze
```

### Local Jupyter Notebook
```bash
jupyter notebook time_series_analysis_agent.ipynb
```

### Streamlit Web App (Future)
```bash
streamlit run streamlit_app.py
```

## üìä Example Outputs

### Revenue Trend Analysis
```
‚úÖ Analysis Result (Status: success)

In 2024, Electronics generated $2.3M in revenue across 1,245 orders,
showing 15% growth vs 2023. Top product was MacBook Air ($450K).
The line chart above shows consistent upward monthly trend with
peak in Q4 2024.
```

### Top Products Table
| Product Name | Total Profit | Quantity Sold | Profit Margin |
|--------------|--------------|---------------|---------------|
| MacBook Air | $450,000 | 346 | 34.6% |
| iPhone 15 Pro | $380,000 | 892 | 29.2% |

## ü§ù Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## üìÑ License

This project is licensed under the MIT License - see the LICENSE file for details.

## üôè Acknowledgments

- **Google Gemini AI** - Natural language code generation
- **Anthropic Claude** - Inspiration from claude-pdf-summarizer project
- **Pandas Community** - Powerful data analysis tools

## üìû Contact

**Lee Yih Ven**
- GitHub: [@lyven81](https://github.com/lyven81)
- Email: your.email@example.com
- Portfolio: [AI Project Portfolio](https://lyven81.github.io/ai-project/)

---

**Built with ‚ù§Ô∏è using Google Gemini AI and Python**
